# üîß Ajuste de Falsos Positivos - Guia R√°pido

## ‚ö†Ô∏è Problema

Se requisi√ß√µes leg√≠timas est√£o sendo bloqueadas, voc√™ pode:

### Op√ß√£o 1: Modo Log-Only (Tempor√°rio)

Ative o modo que apenas **logga** sem bloquear:

**1. Adicione ao `.env.local`:**
```bash
SECURITY_LOG_ONLY=true
```

**2. Reinicie o servidor:**
```bash
npm run dev
```

**3. Use o sistema normalmente e verifique logs:**
```bash
# Procure por:
[SecurityMiddleware] ‚ö†Ô∏è  MODO LOG-ONLY: Detectado mas N√ÉO bloqueado
```

**4. Ap√≥s alguns dias, identifique padr√µes e ajuste**

**5. Desative o modo:**
```bash
# Remova SECURITY_LOG_ONLY do .env.local ou defina como false
SECURITY_LOG_ONLY=false
```

### Op√ß√£o 2: Verificar o que foi Detectado

**Acesse o painel admin:**
```
/admin/injection-attempts
```

**Veja:**
- Qual padr√£o foi detectado
- Qual campo tinha o valor
- Qual era o valor exato

### Op√ß√£o 3: Adicionar √† Whitelist

Se encontrar um padr√£o leg√≠timo que est√° sendo bloqueado:

**1. Edite `src/lib/security/injection-detector.ts`**

**2. Adicione √† lista `SAFE_PATTERNS`:**
```typescript
const SAFE_PATTERNS = [
  // ... padr√µes existentes
  /^SEU_PADRAO_AQUI$/, // Novo padr√£o seguro
]
```

**3. Ou adicione campo seguro:**
```typescript
const SAFE_FIELDS = [
  // ... campos existentes
  'seuCampoSeguro', // Novo campo seguro
]
```

---

## üìä Padr√µes Ajustados Recentemente

Os seguintes padr√µes foram tornados **mais espec√≠ficos** para reduzir falsos positivos:

1. ‚úÖ Command Chaining - agora precisa ser `;;` ou `;rm`, n√£o apenas `;`
2. ‚úÖ SQL Comment - agora precisa estar isolado ou no in√≠cio/fim
3. ‚úÖ Information Function - precisa ter espa√ßo antes
4. ‚úÖ Environment Variable - formato mais espec√≠fico

---

## üß™ Teste de Valida√ß√£o

Teste com valores leg√≠timos comuns:

```bash
# N√£o deve bloquear:
- "Jo√£o Silva (Filho)"
- "Texto com #hashtag"
- "user(name)"
- "valor$123"
- "https://example.com"
- "(11) 99999-9999"
```

---

**√öltima atualiza√ß√£o:** Janeiro 2025

